(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7843],{3097:(e,a,r)=>{"use strict";r.d(a,{L:()=>c});var t=r(35639),i=r(98377),s=r(64533),n=r(28330);function c(){let e=(0,t.jE)(),{data:a,isLoading:r,error:c}=(0,i.I)({queryKey:["productFamilies"],queryFn:async()=>{try{let e=await (0,n.v$)(n.Sn.catalog.productFamilies);if(!e.ok){let a=await e.json().catch(()=>({}));throw Error(a.message||"Failed to fetch product families")}return e.json()}catch(e){throw e instanceof n.Ny&&window.location.replace("/auth/login"),e}}}),o=(0,s.n)({mutationFn:async e=>{try{let a=await (0,n.v$)(n.Sn.catalog.productFamilies,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||"Failed to create product family")}return a.json()}catch(e){throw e instanceof n.Ny&&window.location.replace("/auth/login"),e}},onSuccess:()=>{e.invalidateQueries({queryKey:["productFamilies"]})}}),l=(0,s.n)({mutationFn:async e=>{if(!e.id)throw Error("ID is required for update");try{let a=await (0,n.v$)("".concat(n.Sn.catalog.productFamilies,"/").concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,id:void 0,version:void 0})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||"Failed to update product family")}return a.json()}catch(e){throw e instanceof n.Ny&&window.location.replace("/auth/login"),e}},onSuccess:()=>{e.invalidateQueries({queryKey:["productFamilies"]})}}),d=(0,s.n)({mutationFn:async e=>{try{let a=await (0,n.v$)("".concat(n.Sn.catalog.productFamilies,"/").concat(e),{method:"DELETE"});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||"Failed to delete product family")}}catch(e){throw e instanceof n.Ny&&window.location.replace("/auth/login"),e}},onSuccess:()=>{e.invalidateQueries({queryKey:["productFamilies"]})}});return{families:(null==a?void 0:a.content)||[],isLoading:r,error:c,createFamily:o.mutate,isCreating:o.isPending,createError:o.error,updateFamily:l.mutate,isUpdating:l.isPending,updateError:l.error,deleteFamily:d.mutate,isDeleting:d.isPending,deleteError:d.error}}},22365:(e,a,r)=>{Promise.resolve().then(r.bind(r,96686))},42713:(e,a,r)=>{"use strict";r.d(a,{T:()=>n});var t=r(66384),i=r(16636),s=r(35515);let n=i.forwardRef((e,a)=>{let{className:r,...i}=e;return(0,t.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:a,...i})});n.displayName="Textarea"},64386:(e,a,r)=>{"use strict";r.d(a,{C:()=>c});var t=r(35639),i=r(98377),s=r(64533),n=r(28330);function c(){let e=(0,t.jE)(),{data:a=[],isLoading:r,error:c}=(0,i.I)({queryKey:["categories"],queryFn:async()=>{try{let e=await (0,n.v$)(n.Sn.catalog.categories);if(!e.ok){let a=await e.json().catch(()=>({}));throw Error(a.message||"Failed to fetch categories")}return e.json()}catch(e){throw e instanceof n.Ny&&window.location.replace("/auth/login"),e}}}),o=(0,s.n)({mutationFn:async e=>{let a=await (0,n.v$)(n.Sn.catalog.categories,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||"Failed to create category");return a.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["categories"]})}});return{categories:a,isLoading:r,error:c,createCategory:o,updateCategory:(0,s.n)({mutationFn:async e=>{let a=await (0,n.v$)(n.Sn.catalog.category(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||"Failed to update category");return a.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["categories"]})}}),deleteCategory:(0,s.n)({mutationFn:async e=>{let a=await (0,n.v$)(n.Sn.catalog.category(e),{method:"DELETE"});if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||"Failed to delete category")},onSuccess:()=>{e.invalidateQueries({queryKey:["categories"]})}})}}},84431:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(25787).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},96686:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>N});var t=r(66384),i=r(16636),s=r(55212),n=r(92944),c=r(28016),o=r(46276),l=r(95788),d=r(52142),u=r(42713),h=r(22074),m=r(31238),g=r(84431),p=r(57083),y=r(19934),x=r(1669),j=r(3097),v=r(64386),f=r(78342),w=r(35639);let C=e=>{let a=e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,20).replace(/-+$/,"");return a.length<3&&(a="".concat(a,"-").concat(Math.floor(1e3+9e3*Math.random()))),a.toUpperCase()};function N(){(0,w.jE)();let{families:e,isLoading:a,error:r,createFamily:N,isCreating:b,createError:F,updateFamily:S,isUpdating:E,updateError:k,deleteFamily:A,isDeleting:P,deleteError:q}=(0,j.L)(),{categories:I,isLoading:T,error:$,createCategory:L}=(0,v.C)(),[J,O]=(0,i.useState)(""),[D,B]=(0,i.useState)(!1),[K,z]=(0,i.useState)(null),[M,Q]=(0,i.useState)(!1),[U,_]=(0,i.useState)({name:"",parentId:null,description:""}),[R,Z]=(0,i.useState)({name:"",description:"",categoryId:"",brand:"",insuranceCoverages:[]}),H=async e=>{if(e.preventDefault(),!U.name)return void f.o.error("Category name is required.");let a=C(U.name),r={name:U.name,code:a,parentId:U.parentId,description:U.description,displayOrder:1,isActive:!0,icon:null,taxCategory:"Standard",regulatoryCategory:null,localizedNames:{},metadata:{}};try{let e=await L.mutateAsync(r);f.o.success("Category created successfully"),Q(!1),Y(e.id),_({name:"",parentId:null,description:""})}catch(e){f.o.error(e instanceof Error?e.message:"Failed to create category")}},G=async e=>{e.preventDefault();try{let e={...R};K?(await S({...e,id:K.id,version:K.version}),f.o.success("Product family updated successfully")):(await N(e),f.o.success("Product family created successfully")),B(!1),z(null),V()}catch(e){f.o.error(e instanceof Error?e.message:"An error occurred")}},V=()=>{Z({name:"",description:"",categoryId:"",brand:"",insuranceCoverages:[]})},W=e=>{z(e),Z({name:e.name,description:e.description||"",categoryId:e.category.id,brand:e.brand||"",insuranceCoverages:e.insuranceCoverages||[]}),B(!0)},X=async e=>{try{await A(e),f.o.success("Product family deleted successfully")}catch(e){f.o.error(e instanceof Error?e.message:"Failed to delete product family")}},Y=e=>{Z(a=>({...a,categoryId:e}))};if(a||T)return(0,t.jsx)("div",{children:"Loading..."});if(r||$){var ee;return(0,t.jsxs)("div",{children:["Error: ",(r||$)instanceof Error?null==(ee=r||$)?void 0:ee.message:"An error occurred"]})}return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Product Families"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage product families and their insurance coverages"})]}),(0,t.jsxs)(o.lG,{open:D,onOpenChange:B,children:[(0,t.jsx)(o.zM,{asChild:!0,children:(0,t.jsxs)(s.$,{onClick:()=>{z(null),V(),B(!0)},children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Add Family"]})}),(0,t.jsx)(o.Cf,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("form",{onSubmit:G,children:[(0,t.jsxs)(o.c7,{children:[(0,t.jsx)(o.L3,{children:K?"Edit Product Family":"Add New Product Family"}),(0,t.jsx)(o.rr,{children:K?"Update the product family information below.":"Create a new product family."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"name",children:"Family Name"}),(0,t.jsx)(n.p,{id:"name",value:R.name,onChange:e=>Z({...R,name:e.target.value}),placeholder:"e.g., Premium Moisturizers",required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"description",children:"Full Description"}),(0,t.jsx)(u.T,{id:"description",value:R.description,onChange:e=>Z({...R,description:e.target.value}),placeholder:"Detailed description of the product family"})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"category",children:"Category"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(l.l6,{value:R.categoryId,onValueChange:e=>Y(e),required:!0,children:[(0,t.jsx)(l.bq,{children:(0,t.jsx)(l.yv,{placeholder:"Select category"})}),(0,t.jsx)(l.gC,{children:I.map(e=>(0,t.jsx)(l.eb,{value:e.id,children:e.name},e.id))})]}),(0,t.jsx)(s.$,{type:"button",variant:"outline",onClick:()=>Q(!0),children:(0,t.jsx)(h.A,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"brand",children:"Brand"}),(0,t.jsx)(n.p,{id:"brand",value:R.brand,onChange:e=>Z({...R,brand:e.target.value}),placeholder:"Brand name"})]}),R.insuranceCoverages&&R.insuranceCoverages.length>0&&(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{children:"Insurance Coverages"}),(0,t.jsx)("ul",{className:"list-disc ml-6",children:R.insuranceCoverages.map(e=>(0,t.jsxs)("li",{children:[e.insuranceName||e.insuranceId," - ",e.status," - ",e.clientContributionPercentage,"%"]},e.id||e.insuranceId))})]})]}),(0,t.jsx)(o.Es,{children:(0,t.jsx)(s.$,{type:"submit",disabled:b||E,children:K?"Update":"Create"})})]})})]})]}),(0,t.jsx)(o.lG,{open:M,onOpenChange:Q,children:(0,t.jsx)(o.Cf,{className:"sm:max-w-[600px]",children:(0,t.jsxs)("form",{onSubmit:H,children:[(0,t.jsxs)(o.c7,{children:[(0,t.jsx)(o.L3,{children:"Add New Category"}),(0,t.jsx)(o.rr,{children:"Create a new product category. This will be available for other families."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"new-category-name",children:"Category Name *"}),(0,t.jsx)(n.p,{id:"new-category-name",value:U.name,onChange:e=>_(a=>({...a,name:e.target.value})),placeholder:"e.g., Skincare",required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"new-category-parent",children:"Parent Category"}),(0,t.jsxs)(l.l6,{value:U.parentId||"no-parent",onValueChange:e=>_(a=>({...a,parentId:"no-parent"===e?null:e})),children:[(0,t.jsx)(l.bq,{children:(0,t.jsx)(l.yv,{placeholder:"Select parent category"})}),(0,t.jsxs)(l.gC,{children:[(0,t.jsx)(l.eb,{value:"no-parent",children:"No Parent (Root Category)"}),I.map(e=>(0,t.jsx)(l.eb,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(d.J,{htmlFor:"new-category-desc",children:"Description"}),(0,t.jsx)(u.T,{id:"new-category-desc",value:U.description,onChange:e=>_(a=>({...a,description:e.target.value})),placeholder:"Category description"})]})]}),(0,t.jsx)(o.Es,{children:(0,t.jsx)(s.$,{type:"submit",disabled:L.isPending,children:L.isPending?"Creating...":"Create Category"})})]})})}),(0,t.jsxs)(y.Zp,{children:[(0,t.jsxs)(y.aR,{children:[(0,t.jsx)(y.ZB,{children:"Search"}),(0,t.jsx)(y.BT,{children:"Find product families by name or brand"})]}),(0,t.jsx)(y.Wu,{children:(0,t.jsx)("div",{className:"flex gap-4",children:(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(n.p,{placeholder:"Search families...",value:J,onChange:e=>O(e.target.value),className:"pl-10"})]})})})]}),(0,t.jsxs)(y.Zp,{children:[(0,t.jsxs)(y.aR,{children:[(0,t.jsxs)(y.ZB,{children:["Product Families (",e.length,")"]}),(0,t.jsx)(y.BT,{children:"All product families in the system"})]}),(0,t.jsx)(y.Wu,{children:(0,t.jsxs)(c.XI,{children:[(0,t.jsx)(c.A0,{children:(0,t.jsxs)(c.Hj,{children:[(0,t.jsx)(c.nd,{children:"Family Name"}),(0,t.jsx)(c.nd,{children:"Category"}),(0,t.jsx)(c.nd,{children:"Brand"}),(0,t.jsx)(c.nd,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(c.BF,{children:e.filter(e=>e.name.toLowerCase().includes(J.toLowerCase())||(e.brand||"").toLowerCase().includes(J.toLowerCase())).map(e=>(0,t.jsxs)(c.Hj,{children:[(0,t.jsx)(c.nA,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.description})]})}),(0,t.jsx)(c.nA,{children:(0,t.jsx)(x.E,{variant:"secondary",children:e.category.name})}),(0,t.jsx)(c.nA,{children:e.brand}),(0,t.jsx)(c.nA,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(s.$,{variant:"ghost",size:"icon",onClick:()=>W(e),children:(0,t.jsx)(g.A,{className:"h-4 w-4"})}),(0,t.jsx)(s.$,{variant:"ghost",size:"icon",onClick:()=>X(e.id),children:(0,t.jsx)(p.A,{className:"h-4 w-4"})})]})})]},e.id))})]})})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[9414,2261,5716,8377,7026,9297,9037,6338,6565,9309,951,7358],()=>a(22365)),_N_E=e.O()}]);